{"version":3,"sources":["sharepoint/SharepointServiceManager.ts"],"names":[],"mappings":"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","file":"sharepoint/SharepointServiceManager.js","sourcesContent":["import { WebPartContext } from \"@microsoft/sp-webpart-base\";\nimport { SPHttpClient } from \"@microsoft/sp-http\";\n\nexport class SharepointServiceManager {\n  context: WebPartContext;\n\n  public setup(context: WebPartContext) {\n    this.context = context;\n  }\n\n  public get(siteCollection: string, relativeURL: string): Promise<any> {\n    return this.context.spHttpClient\n      .get(siteCollection + relativeURL, SPHttpClient.configurations.v1)\n      .then((result) => result.json());\n  }\n\n  public getLists(siteCollection: string): Promise<any> {\n    return this.get(siteCollection, \"/_api/Web/Lists?&$select=Title,ID\");\n  }\n\n  public getListItems(\n    siteCollection: string,\n    listID: string,\n    userId: string\n  ): Promise<any> {\n    return this.get(\n      siteCollection,\n      `/_api/Web/Lists/getbyid('${listID}')/items?$select=*,Status/InternalName,AssignedTo/Name,AssignedTo/Title&$expand=Status,AssignedTo&$filter=RequesterSPUserStringId%20eq%20${userId}`\n    );\n  }\n  public getCategories(siteCollection: string): Promise<any> {\n    return this.get(\n      siteCollection,\n      `/_api/Web/Lists/getbytitle('Tickets')/fields?$filter=EntityPropertyName%20eq%20%27Category%27`\n    );\n  }\n  public getPriorities(siteCollection: string): Promise<any> {\n    return this.get(\n      siteCollection,\n      `/_api/Web/Lists/getbytitle('Tickets')/fields?$filter=EntityPropertyName%20eq%20%27Priority%27`\n    );\n  }\n  public getIncidents(siteCollection: string): Promise<any> {\n    return this.get(\n      siteCollection,\n      `/_api/Web/Lists/getbytitle('Incidents%20r√©currents')/items`\n    );\n  }\n  public getAgences(siteCollection: string): Promise<any> {\n    return this.get(\n      siteCollection,\n      `/_api/Web/Lists/getbytitle('Agences')/items?$select=*,DRE_x0020_de_x0020_l_x0027_agenc/Title&$expand=DRE_x0020_de_x0020_l_x0027_agenc&$top=10000&$orderby=Code_x0020_Agence asc`\n    );\n  }\n  public getDirections(siteCollection: string): Promise<any> {\n    return this.get(\n      siteCollection,\n      `/_api/Web/Lists/getbytitle('Directions')/items?$select=*,Code_x0020_de_x0020_la_x0020_div/Title&$expand=Code_x0020_de_x0020_la_x0020_div&$top=10000&$orderby=Code_x0020_de_x0020_la_x0020_dir asc`\n    );\n  }\n  public getDivisions(siteCollection: string): Promise<any> {\n    return this.get(\n      siteCollection,\n      `/_api/Web/Lists/getbytitle('Divisions')/items?$orderby=Code_x0020_Division asc`\n    );\n  }\n  public getComments(siteCollection: string, itemID): Promise<any> {\n    return this.get(\n      siteCollection,\n      `/_api/Web/Lists/getbytitle('Comments')/items?$select=*,Title,Author/ID,Author/Title,Author/LastName,Editor/ID,Editor/Title,Editor/LastName&$&$expand=Author,Editor&$filter=TicketId%20eq%20${itemID}`\n    );\n  }\n  public getUserDetails(siteCollection: string, CommentUserID): Promise<any> {\n    return this.get(siteCollection, `/_api/web/getuserbyid(${CommentUserID})`);\n  }\n  public getUserContactId(siteCollection: string, userId): Promise<any> {\n    return this.get(\n      siteCollection,\n      `/_api/Web/Lists/getbytitle('Contacts')/items?$filter=SPUserId%20eq%20${userId}&$select=Id`\n    );\n  }\n\n  public post(\n    absoluteURL: string,\n    relativePath: string,\n    body: any\n  ): Promise<any> {\n    return this.context.spHttpClient\n      .post(absoluteURL + relativePath, SPHttpClient.configurations.v1, {\n        body: body,\n        headers: {\n          Accept: \"application/json;odata=nometadata\",\n          \"Content-type\": \"application/json;odata=nometadata\",\n          \"odata-version\": \"\",\n          \"IF-MATCH\": \"*\",\n        },\n      })\n     \n      .catch((error) => Promise.reject(error));\n  }\n\n  public AddComment(absoluteURL: string, listID: string, item: any) {\n    return this.post(\n      absoluteURL,\n      `/_api/web/lists/getbyid('${listID}')/items`,\n      JSON.stringify(item)\n    );\n  }\n  public AddTicket(absoluteURL: string, listID: string, item: any) {\n    return this.post(\n      absoluteURL,\n      `/_api/web/lists/getbyid('${listID}')/items`,\n      JSON.stringify(item)\n    ).then(response => {return response});\n  }\n  public delete(absoluteURL: string, relativePath: string): Promise<any> {\n    return this.context.spHttpClient\n      .post(absoluteURL + relativePath, SPHttpClient.configurations.v1, {\n        headers: {\n          Accept: \"application/json;odata=nometadata\",\n          \"Content-type\": \"application/json;odata=nometadata\",\n          \"odata-version\": \"\",\n          \"IF-MATCH\": \"*\",\n          \"X-HTTP-Method\": \"DELETE\",\n        },\n      })\n      .then((response) => response.json())\n      .catch((error) => Promise.reject(error));\n  }\n  public DeleteComment(absoluteURL: string, listID: string, item: any) {\n    return this.delete(\n      absoluteURL,\n      `/_api/web/lists/getbyid('${listID}')/items(${item})`\n    );\n  }\n}\n\nconst SharepointService = new SharepointServiceManager();\n\nexport default SharepointService;\n"],"sourceRoot":"..\\..\\src"}