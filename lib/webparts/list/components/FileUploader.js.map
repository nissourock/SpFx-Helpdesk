{"version":3,"sources":["webparts/list/components/FileUploader.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAC/B,OAAO,EAAE,aAAa,EAAE,MAAM,mCAAmC,CAAC;AAClE,OAAO,EAAE,eAAe,EAAE,MAAM,kCAAkC,CAAC;AACnE,OAAO,iBAAiB,MAAM,8CAA8C,CAAC;AAC7E,OAAO,EAAE,YAAY,EAAqB,MAAM,2DAA2D,CAAC;AAI5G,OAAO,EAAE,iBAAiB,EAAE,MAAM,sBAAsB,CAAC;AACzD,OAAO,KAAK,MAAM,MAAM,QAAQ,CAAC;AACjC,OAAO,EAAQ,kBAAkB,EAAE,IAAI,EAAU,MAAM,wBAAwB,CAAC;AAEhF,OAAO,EAAE,KAAK,EAAE,MAAM,kCAAkC,CAAC;AAQzD,IAAM,aAAa,GAA+B;IAChD,WAAW,EAAE;QACX,SAAS,EAAE,MAAM;KAClB;IACD,QAAQ,EAAE;QACR,UAAU,EAAE,MAAM;KACnB;CACF,CAAC;AAEF,IAAM,aAAa,GAAG,kBAAkB,EAA8D,CAAC;AAEvG,eAAe,EAAE,CAAC;AAElB;IAA2B,gCAA4D;IAGrF,sBAAY,KAAK;QAAjB,YACE,kBAAM,KAAK,CAAC,SAGb;QAQM,wBAAkB,GAAG,UAAC,KAAa,EAAE,UAAU;YACpD,MAAM,CAAC,OAAO,CAAC,YAAY,GAAG,IAAI,CAAC;YACnC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;gBACZ,KAAK,SAAS;oBACV,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;oBAC3B,KAAK,CAAC;YAGd,CAAC;QACL,CAAC,CAAA;QAnBG,iBAAiB,CAAC,OAAO,CAAC,sGAAsG,CAAC,CAAC;QAClI,KAAI,CAAC,gBAAgB,GAAG,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;;IAC3D,CAAC;IAED,uCAAgB,GAAhB,UAAiB,QAAQ;QAAzB,iBAKC;QAJC,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QACrC,oDAAoD;QACpD,iBAAiB,CAAC,IAAI,CAAC,wBAAwB,EAAC,iDAA+C,QAAQ,wCAAmC,IAAI,CAAC,IAAI,OAAI,EAAE,IAAI,CAAE,CAAC,IAAI,CAAC,cAAK,OAAA,KAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,gCAAgC,CAAC,EAApE,CAAoE,CAAC,CAAC,IAAI,CAAC,cAAK,OAAA,KAAI,CAAC,KAAK,CAAC,YAAY,EAAE,EAAzB,CAAyB,CAAC,CAAA;QACpR,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACpB,CAAC;IAYD,6BAAM,GAAN;QAAA,iBAsDC;QArDC,IAAM,oBAAoB,GAA8D;YAKpF;gBACE,GAAG,EAAE,CAAC;gBACN,mBAAmB,EAAE;oBACnB,8BAAM,GAAG,EAAE,CAAC,sBAEL;oBACP,8BAAM,GAAG,EAAE,CAAC,uBAAyB;iBACtC;gBACD,YAAY,EAAE,oBAAC,IAAI,IAAC,QAAQ,EAAE,KAAK,GAAI;gBACvC,SAAS,EAAE,IAAI;aAChB;YACD;gBACE,GAAG,EAAE,CAAC;gBACN,mBAAmB,EAAE;oBACnB,8BAAM,GAAG,EAAE,CAAC,uBAEL;oBACP,8BAAM,GAAG,EAAE,CAAC,wBAA0B;iBACvC;gBACD,YAAY,EAAE,oBAAC,IAAI,IAAC,QAAQ,EAAE,OAAO,GAAI;gBACzC,SAAS,EAAE,IAAI;aAChB;SACF,CAAC;QAEF,IAAM,mBAAmB,GAAuB,EAAE,CAAC;QACnD,oBAAoB,CAAC,OAAO,CAAC,UAAC,IAA8B;YAC1D,IAAM,KAAK,GAAG,IAAI,CAAC;YACnB,mBAAmB,CAAC,IAAI,CAAC,oBAAC,YAAY,eAAK,KAA2B,IAAE,GAAG,EAAE,IAAI,CAAC,GAAG,IAAK,CAAC,CAAC;QAC9F,CAAC,CAAC,CAAC;QACL,MAAM,CAAC,CACL;YACE,+BACE,IAAI,EAAC,MAAM,EACX,GAAG,EAAE,UAAC,KAAK,IAAO,KAAI,CAAC,SAAS,GAAG,KAAK,CAAC,CAAC,CAAC,EAC3C,KAAK,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,EACxB,QAAQ,EAAE,cAAI,OAAA,KAAI,CAAC,gBAAgB,CAAC,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAA1C,CAA0C,GAC1D;YACF,6BAAK,KAAK,EAAE,EAAC,OAAO,EAAE,MAAM,EAAE,aAAa,EAAC,QAAQ,EAAE,GAAG,EAAC,MAAM,EAAC;gBAC7D,oBAAC,KAAK,8BAAuB;;gBAE7B,oBAAC,aAAa,IACZ,IAAI,EAAC,wBAAwB,EAC7B,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,SAAS,CAAC,KAAK,EAAE,EAAtB,CAAsB,EACrC,KAAK,EAAE,EAAC,KAAK,EAAE,KAAK,EAAC,GACrB,CACA,CACF,CACP,CAAC;IACJ,CAAC;IACH,mBAAC;AAAD,CAjFA,AAiFC,CAjF0B,KAAK,CAAC,SAAS,GAiFzC;AAED,eAAe,YAAY,CAAC","file":"webparts/list/components/FileUploader.js","sourcesContent":["import * as React from 'react';\r\nimport { PrimaryButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { initializeIcons } from 'office-ui-fabric-react/lib/Icons';\r\nimport SharepointService from '../../../sharepoint/SharepointServiceManager';\r\nimport { ActivityItem,IActivityItemProps } from \"office-ui-fabric-react/lib-es2015/components/ActivityItem\";\r\n\r\nimport styles from './ToastrSample.module.scss';\r\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { SPComponentLoader } from '@microsoft/sp-loader';\r\nimport * as toastr from 'toastr';\r\nimport {  css, classNamesFunction, Icon, IStyle } from 'office-ui-fabric-react';\r\n\r\nimport { Label } from \"office-ui-fabric-react/lib/Label\";\r\ntype IActivityItemExampleStyleProps = {};\r\n\r\ninterface IActivityItemExampleStyles {\r\n  exampleRoot?: IStyle;\r\n  nameText?: IStyle;\r\n}\r\n\r\nconst exampleStyles: IActivityItemExampleStyles = {\r\n  exampleRoot: {\r\n    marginTop: '20px'\r\n  },\r\n  nameText: {\r\n    fontWeight: 'bold'\r\n  }\r\n};\r\n\r\nconst getClassNames = classNamesFunction<IActivityItemExampleStyleProps, IActivityItemExampleStyles>();\r\n\r\ninitializeIcons();\r\n\r\nclass FileUploader extends React.Component<{ticketID: any, fileUploaded: ()=> void},{}> {\r\n  fileInput: any;\r\n  \r\n  constructor(props) {\r\n    super(props);\r\n    SPComponentLoader.loadCss('https://support.bna.dz/SiteAssets/cdnjs.cloudflare.com_ajax_libs_toastr.js_latest_css_toastr.min.css');\r\n    this.handleFileUpload = this.handleFileUpload.bind(this);\r\n  }\r\n\r\n  handleFileUpload(ticketID) {\r\n    const file = this.fileInput.files[0];\r\n    // Perform additional actions with the uploaded file\r\n    SharepointService.post(\"https://support.bna.dz\",`/_api/web/lists/getByTitle('Tickets')/items(${ticketID})/AttachmentFiles/add(FileName='${file.name}')`, file ).then(()=> this._showToastrMessage(\"success\", \"Pièce jointe ajoutée au ticket\")).then(()=> this.props.fileUploaded())\r\n    console.log(file);\r\n  }\r\n  public _showToastrMessage = (scope: string, textToShow) => {\r\n    toastr.options.hideDuration = 5000;\r\n    switch (scope) {\r\n        case \"success\":\r\n            toastr.success(textToShow);\r\n            break;\r\n       \r\n          \r\n    }\r\n}\r\n\r\n  render() {\r\n    const activityItemExamples: Partial<IActivityItemProps & React.ClassAttributes<{}>>[] = [\r\n        \r\n       \r\n        \r\n         \r\n        {\r\n          key: 3,\r\n          activityDescription: [\r\n            <span key={1} >\r\n              Sabrina De Luca\r\n            </span>,\r\n            <span key={2}> added this file</span>\r\n          ],\r\n          activityIcon: <Icon iconName={'Add'} />,\r\n          isCompact: true\r\n        },\r\n        {\r\n          key: 4,\r\n          activityDescription: [\r\n            <span key={1} >\r\n              Chuan Rojumanong\r\n            </span>,\r\n            <span key={2}> shared this file</span>\r\n          ],\r\n          activityIcon: <Icon iconName={'Share'} />,\r\n          isCompact: true\r\n        }\r\n      ];\r\n  \r\n      const activityExampleList: Array<JSX.Element> = [];\r\n      activityItemExamples.forEach((item: { key: string | number }) => {\r\n        const props = item;\r\n        activityExampleList.push(<ActivityItem {...props as IActivityItemProps} key={item.key}  />);\r\n      });\r\n    return (\r\n      <div>\r\n        <input\r\n          type=\"file\"\r\n          ref={(input) => { this.fileInput = input; }}\r\n          style={{ display: 'none' }}\r\n            onChange={()=>this.handleFileUpload(this.props.ticketID)}\r\n        />\r\n        <div style={{display: \"flex\", flexDirection:\"column\", gap:\"10px\"}}>\r\n            <Label>Pièces jointes</Label>\r\n            Vous pouvez ajouter des pièces jointes (captures d'écran, fichier pdf...etc)\r\n            <PrimaryButton\r\n              text=\"Téléverser un fichier \"\r\n              onClick={() => this.fileInput.click()}\r\n              style={{width: \"25%\"}}\r\n            />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default FileUploader;"],"sourceRoot":"..\\..\\..\\..\\src"}